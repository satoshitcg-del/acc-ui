# เทสเคสระบบบัญชี - ภาษาไทย

ไดเรกทอรีนี้ประกอบด้วยเทสเคสที่ครอบคลุมสำหรับแอปพลิเคชันระบบบัญชี โดยใช้ภาษาไทยในการอธิบายและทดสอบ

## โครงสร้างเทสเคส

```
test.th/
├── setup.ts                    # การตั้งค่าเทสเคส
├── integration/                 # เทสเคสแบบครบวงจร
│   ├── auth.th.test.tsx       # เทสการยืนยันตัวตน
│   └── customer.th.test.tsx   # เทสการจัดการลูกค้า
└── README.md                   # ไฟล์นี้
```

## ประเภทเทสเคส

### 1. เทสเคส Unit Tests
- **ฟังก์ชันพื้นฐาน**: การจัดการข้อผิดพลาด, ฟังก์ชันวันที่
- **บริการ**: ฟังก์ชันบริการ API
- **คอมโพเนนต์**: คอมโพเนนต์ React แต่ละตัว

### 2. เทสเคส Integration Tests
- **การไหลของการยืนยันตัวตน**: เข้าสู่ระบบ, ตั้งรหัสผ่าน, 2FA
- **การจัดการลูกค้า**: การดำเนินการ CRUD, การค้นหา, การกรอง
- **ระบบบิล**: การสร้างบิล, การอัพเดทสถานะ, การสร้าง PDF
- **การจัดการงาน**: การสร้างงาน, การมอบหมาย, การติดตามสถานะ

### 3. เทสเคสบริการ
- **UserService**: การยืนยันตัวตน, การจัดการรหัสผ่าน, 2FA
- **CustomerService**: การดำเนินการ CRUD ลูกค้า
- **ProductService**: การจัดการสินค้าและสินค้าย่อย
- **BillingService**: การดำเนินการบิล, การสร้าง PDF
- **TaskManagementService**: การดำเนินการ CRUD งาน
- **DirectApiService**: การรวม Direct API

## การรันเทสเคส

### รันเทสเคสทั้งหมด
```bash
yarn test:th
```

### รันเทสเคสพร้อม Coverage
```bash
yarn test:th:coverage
```

### รันเทสเคสเฉพาะ Integration Tests
```bash
yarn test:th:integration
```

### รันเทสเคสเฉพาะ Unit Tests
```bash
yarn test:th:unit
```

### รันเทสเคสแบบ Watch Mode
```bash
yarn test:th:watch
```

## การตั้งค่าเทสเคส

เทสเคสถูกตั้งค่าโดยใช้ Vitest พร้อมการตั้งค่าดังนี้:

- **สภาพแวดล้อม**: happy-dom (การใช้งาน DOM แบบเบา)
- **Coverage**: v8 provider พร้อมรายงาน HTML, JSON, และ text
- **การตั้งค่า**: ไฟล์การตั้งค่าแบบกำหนดเองพร้อม DOM matchers และ mocks
- **Aliases**: Path aliases สำหรับการ import ที่สะอาด

## การครอบคลุมเทสเคส

ชุดเทสเคสครอบคลุม:

1. **การจัดการข้อผิดพลาด**: รหัสข้อผิดพลาดทั้งหมดและกรณีขอบ
2. **การยืนยันตัวตน**: การไหลของการยืนยันตัวตนแบบสมบูรณ์รวมถึง 2FA
3. **การจัดการลูกค้า**: การดำเนินการ CRUD, การค้นหา, การกรอง
4. **การจัดการสินค้า**: การดำเนินการสินค้าและสินค้าย่อย
5. **ระบบบิล**: การสร้างบิล, การอัพเดทสถานะ, การสร้าง PDF
6. **การจัดการงาน**: การไหลของงาน, การมอบหมาย, การติดตามสถานะ
7. **การรวม API**: จุดสิ้นสุดบริการทั้งหมดและการจัดการข้อผิดพลาด

## กลยุทธ์การ Mock

- **บริการ**: การเรียก API ที่จำลองด้วยการตอบกลับที่สมจริง
- **คอมโพเนนต์**: คอมโพเนนต์ย่อยที่จำลองเพื่อการแยกส่วน
- **Router**: การนำทางและการกำหนดเส้นทางที่จำลอง
- **DOM APIs**: Browser APIs ที่จำลอง (matchMedia, IntersectionObserver, etc.)

## แนวทางปฏิบัติที่ดี

1. **การแยกส่วน**: แต่ละเทสเป็นอิสระและไม่ส่งผลต่อเทสอื่น
2. **การจำลอง**: การพึ่งพาภายนอกถูกจำลองอย่างเหมาะสม
3. **การครอบคลุม**: เส้นทางที่สำคัญทั้งหมดได้รับการทดสอบ
4. **สถานการณ์ข้อผิดพลาด**: ทั้งกรณีสำเร็จและล้มเหลวได้รับการครอบคลุม
5. **การโต้ตอบของผู้ใช้**: การกระทำของผู้ใช้ได้รับการจำลองอย่างเหมาะสม
6. **การดำเนินการแบบ Async**: การจัดการการดำเนินการแบบ async อย่างเหมาะสมด้วย waitFor

## การเพิ่มเทสเคสใหม่

เมื่อเพิ่มฟังก์ชันใหม่:

1. สร้างเทส unit สำหรับยูทิลิตี้และบริการใหม่
2. เพิ่มเทส integration สำหรับการไหลของผู้ใช้ใหม่
3. อัพเดทเทสที่มีอยู่หากอินเทอร์เฟซเปลี่ยนแปลง
4. ตรวจสอบให้แน่ใจว่าการจำลองการพึ่งพาใหม่อย่างเหมาะสม
5. เพิ่มสถานการณ์ข้อผิดพลาดและกรณีขอบ

## ข้อมูลเทสเคส

ข้อมูลเทสเคสถูกสร้างแบบไดนามิกเพื่อหลีกเลี่ยงค่าที่เข้ารหัส:

- **การตอบกลับจำลอง**: โครงสร้างการตอบกลับ API ที่สมจริง
- **ข้อมูลผู้ใช้**: ข้อมูลลูกค้า, สินค้า, และบิลตัวอย่าง
- **สถานการณ์ข้อผิดพลาด**: สภาวะข้อผิดพลาดและกรณีขอบต่างๆ
- **ข้อมูลฟอร์ม**: อินพุตฟอร์มที่ถูกต้องและไม่ถูกต้อง

## การรวมต่อเนื่อง

เทสเคสได้รับการออกแบบให้รันในสภาพแวดล้อม CI/CD:

- **Headless**: ไม่ต้องการเบราว์เซอร์
- **เร็ว**: เพิ่มประสิทธิภาพสำหรับการตอบกลับที่รวดเร็ว
- **เชื่อถือได้**: ผลลัพธ์ที่กำหนดได้
- **Coverage**: การรายงานการครอบคลุมที่ครอบคลุม